{
  "select": ["country", {"AVG": "total_price"}],
  "from": "events",
  "where": [
    {"col": "type", "op": "eq", "val": "purchase"}
  ],
  "group_by": ["country"],
  "order_by": [
    {"col": "AVG(total_price)", "dir": "desc"}
  ]
}
